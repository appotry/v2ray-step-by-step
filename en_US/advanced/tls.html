<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TLS | V2Ray Beginner&#39;s Guide</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Step-by-step guide for first-timers' using V2Ray.">
    
    <link rel="preload" href="/assets/css/0.styles.acb9685a.css" as="style"><link rel="preload" href="/assets/js/app.319c1fa4.js" as="script"><link rel="preload" href="/assets/js/2.634a57e3.js" as="script"><link rel="preload" href="/assets/js/8.3afc79f6.js" as="script"><link rel="prefetch" href="/assets/js/10.2ab7988b.js"><link rel="prefetch" href="/assets/js/100.312ef596.js"><link rel="prefetch" href="/assets/js/101.db1901ca.js"><link rel="prefetch" href="/assets/js/102.6cf06404.js"><link rel="prefetch" href="/assets/js/103.a8077f2e.js"><link rel="prefetch" href="/assets/js/104.3eb13793.js"><link rel="prefetch" href="/assets/js/11.93b9e3f2.js"><link rel="prefetch" href="/assets/js/12.c5af76dc.js"><link rel="prefetch" href="/assets/js/13.e5087840.js"><link rel="prefetch" href="/assets/js/14.33bceb5a.js"><link rel="prefetch" href="/assets/js/15.f12e1357.js"><link rel="prefetch" href="/assets/js/16.f383bc1b.js"><link rel="prefetch" href="/assets/js/17.851bc3bf.js"><link rel="prefetch" href="/assets/js/18.fbf174f8.js"><link rel="prefetch" href="/assets/js/19.defa8e1a.js"><link rel="prefetch" href="/assets/js/20.932b2db8.js"><link rel="prefetch" href="/assets/js/21.b1e45444.js"><link rel="prefetch" href="/assets/js/22.e85320e0.js"><link rel="prefetch" href="/assets/js/23.f7bd1711.js"><link rel="prefetch" href="/assets/js/24.7a7a05e6.js"><link rel="prefetch" href="/assets/js/25.1f4e0049.js"><link rel="prefetch" href="/assets/js/26.b5e8ba00.js"><link rel="prefetch" href="/assets/js/27.089cbd1d.js"><link rel="prefetch" href="/assets/js/28.760bbb28.js"><link rel="prefetch" href="/assets/js/29.878923db.js"><link rel="prefetch" href="/assets/js/3.21b3bd68.js"><link rel="prefetch" href="/assets/js/30.bbce839e.js"><link rel="prefetch" href="/assets/js/31.f2e57325.js"><link rel="prefetch" href="/assets/js/32.9d7aa670.js"><link rel="prefetch" href="/assets/js/33.fd7fc541.js"><link rel="prefetch" href="/assets/js/34.864aa825.js"><link rel="prefetch" href="/assets/js/35.2b725083.js"><link rel="prefetch" href="/assets/js/36.c4e976a3.js"><link rel="prefetch" href="/assets/js/37.1b6a8806.js"><link rel="prefetch" href="/assets/js/38.3974d4b0.js"><link rel="prefetch" href="/assets/js/39.e7d0b2e5.js"><link rel="prefetch" href="/assets/js/4.e4e11a9d.js"><link rel="prefetch" href="/assets/js/40.f921051f.js"><link rel="prefetch" href="/assets/js/41.19ce4c62.js"><link rel="prefetch" href="/assets/js/42.b508ec0b.js"><link rel="prefetch" href="/assets/js/43.29d8a45a.js"><link rel="prefetch" href="/assets/js/44.2dab3507.js"><link rel="prefetch" href="/assets/js/45.1279e686.js"><link rel="prefetch" href="/assets/js/46.f46ca079.js"><link rel="prefetch" href="/assets/js/47.b35e3f94.js"><link rel="prefetch" href="/assets/js/48.2272a13d.js"><link rel="prefetch" href="/assets/js/49.a9a5579d.js"><link rel="prefetch" href="/assets/js/5.e6bff27c.js"><link rel="prefetch" href="/assets/js/50.6c4f6a91.js"><link rel="prefetch" href="/assets/js/51.3c8e1bfb.js"><link rel="prefetch" href="/assets/js/52.6e8e45d1.js"><link rel="prefetch" href="/assets/js/53.98182984.js"><link rel="prefetch" href="/assets/js/54.7543d427.js"><link rel="prefetch" href="/assets/js/55.636316fb.js"><link rel="prefetch" href="/assets/js/56.868924aa.js"><link rel="prefetch" href="/assets/js/57.4ffb71e0.js"><link rel="prefetch" href="/assets/js/58.75502ef8.js"><link rel="prefetch" href="/assets/js/59.4a39708f.js"><link rel="prefetch" href="/assets/js/6.7d390845.js"><link rel="prefetch" href="/assets/js/60.1f8dd688.js"><link rel="prefetch" href="/assets/js/61.68cec899.js"><link rel="prefetch" href="/assets/js/62.d99a96a0.js"><link rel="prefetch" href="/assets/js/63.b70f527d.js"><link rel="prefetch" href="/assets/js/64.ae2eaf92.js"><link rel="prefetch" href="/assets/js/65.aa8b1323.js"><link rel="prefetch" href="/assets/js/66.f586f6fc.js"><link rel="prefetch" href="/assets/js/67.73c99724.js"><link rel="prefetch" href="/assets/js/68.1154a822.js"><link rel="prefetch" href="/assets/js/69.0d59b8b7.js"><link rel="prefetch" href="/assets/js/7.290967ec.js"><link rel="prefetch" href="/assets/js/70.7df3f334.js"><link rel="prefetch" href="/assets/js/71.d2a5a2b6.js"><link rel="prefetch" href="/assets/js/72.7d60cac1.js"><link rel="prefetch" href="/assets/js/73.3cdaa253.js"><link rel="prefetch" href="/assets/js/74.18784001.js"><link rel="prefetch" href="/assets/js/75.e97d24dd.js"><link rel="prefetch" href="/assets/js/76.14c510d8.js"><link rel="prefetch" href="/assets/js/77.7bf7ff01.js"><link rel="prefetch" href="/assets/js/78.fa0aabf1.js"><link rel="prefetch" href="/assets/js/79.3b9f75d7.js"><link rel="prefetch" href="/assets/js/80.8b7b4b8b.js"><link rel="prefetch" href="/assets/js/81.2a548eac.js"><link rel="prefetch" href="/assets/js/82.698b4345.js"><link rel="prefetch" href="/assets/js/83.6c7a3f68.js"><link rel="prefetch" href="/assets/js/84.c55e0760.js"><link rel="prefetch" href="/assets/js/85.9b2f67ab.js"><link rel="prefetch" href="/assets/js/86.49f5303e.js"><link rel="prefetch" href="/assets/js/87.a98dc301.js"><link rel="prefetch" href="/assets/js/88.a3b242f9.js"><link rel="prefetch" href="/assets/js/89.20668025.js"><link rel="prefetch" href="/assets/js/9.4d60c8eb.js"><link rel="prefetch" href="/assets/js/90.0c459eff.js"><link rel="prefetch" href="/assets/js/91.dd87256b.js"><link rel="prefetch" href="/assets/js/92.7c6f0dbd.js"><link rel="prefetch" href="/assets/js/93.cba8172b.js"><link rel="prefetch" href="/assets/js/94.f84108c5.js"><link rel="prefetch" href="/assets/js/95.cd18b8a5.js"><link rel="prefetch" href="/assets/js/96.dad6f691.js"><link rel="prefetch" href="/assets/js/97.5f3874ec.js"><link rel="prefetch" href="/assets/js/98.fc39fc1b.js"><link rel="prefetch" href="/assets/js/99.44a17d29.js">
    <link rel="stylesheet" href="/assets/css/0.styles.acb9685a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en_US/" class="home-link router-link-active"><!----> <span class="site-name">V2Ray Beginner's Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/tls.html" class="nav-link">
  zh-CN
</a></li><li class="dropdown-item"><!----> <a href="/en_US/advanced/tls.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/tls.html" class="nav-link">
  zh-CN
</a></li><li class="dropdown-item"><!----> <a href="/en_US/advanced/tls.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Preface</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/" aria-current="page" class="sidebar-link">Guide to V2Ray configuration</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/prep/prep" class="sidebar-heading clickable"><span>Before start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/basics/basics" class="sidebar-heading clickable"><span>Basics</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/advanced/advanced" class="sidebar-heading clickable open"><span>Advanced</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/advanced/mux.html" class="sidebar-link">Mux</a></li><li><a href="/en_US/advanced/mkcp.html" class="sidebar-link">mKCP</a></li><li><a href="/en_US/advanced/dynamicport.html" class="sidebar-link">Dynamic Port</a></li><li><a href="/en_US/advanced/outboundproxy.html" class="sidebar-link">Proxy Forwarding</a></li><li><a href="/en_US/advanced/httpfake.html" class="sidebar-link">HTTP Obfuscation</a></li><li><a href="/en_US/advanced/tls.html" aria-current="page" class="active sidebar-link">TLS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#register-a-domain" class="sidebar-link">Register a domain</a></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#generate-certificate" class="sidebar-link">Generate Certificate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#install-acme-sh" class="sidebar-link">Install acme.sh</a></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#generate-certificate-with-acme-sh" class="sidebar-link">Generate certificate with acme.sh</a></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#install-certificate-and-private-key" class="sidebar-link">Install Certificate and Private Key</a></li></ul></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#configure-v2ray" class="sidebar-link">Configure V2Ray</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#server-side-configuration" class="sidebar-link">Server-side configuration</a></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#client-side-configuraion" class="sidebar-link">Client-side configuraion</a></li></ul></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#verify" class="sidebar-link">Verify</a></li><li class="sidebar-sub-header"><a href="/en_US/advanced/tls.html#tip" class="sidebar-link">Tip</a></li></ul></li><li><a href="/en_US/advanced/websocket.html" class="sidebar-link">WebSocket</a></li><li><a href="/en_US/advanced/wss_and_web.html" class="sidebar-link">WebSocket+TLS+Web</a></li><li><a href="/en_US/advanced/h2.html" class="sidebar-link">HTTP/2</a></li><li><a href="/en_US/advanced/cdn.html" class="sidebar-link">CDN</a></li><li><a href="/en_US/advanced/traffic.html" class="sidebar-link">Traffic Statistics</a></li><li><a href="/en_US/advanced/not_recommend.html" class="sidebar-link">Not recommended configurations</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/app/app" class="sidebar-heading clickable"><span>Practical</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/routing/routing" class="sidebar-heading clickable"><span>Routing</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tls"><a href="#tls" class="header-anchor">#</a> TLS</h1> <p>Since version 1.19, V2Ray introduced transport layer security (TLS) support. If you have not heard that before, you may want to Google it first. Otherwise, these articles are also good introductions:</p> <p><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener noreferrer">Brief Intro to SSL/TLS protocol mechanism<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreferrer">(Wikipedia) Transport Layer Security<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="register-a-domain"><a href="#register-a-domain" class="header-anchor">#</a> Register a domain</h2> <p>If you have already registered a domain name, you may skip this step.
TLS requires a registered domain, either free or paid are available and usable, so feel free to use a free domain, while in general, a paid domain would be better than a free one. Let's just assume you know how to get a working domain. If not, just simply Google it. There are plenty of better and detailed tutorials out there.</p> <p><strong>Note that, you need to add an A record points to your server IP address, after you register domain.</strong></p> <p><strong>The following configuration example will assume the registered domain is <code>mydomian.me</code>. Remember to replace it with your own ones.</strong></p> <h2 id="generate-certificate"><a href="#generate-certificate" class="header-anchor">#</a> Generate Certificate</h2> <p>TLS is a certificate authentication mechanism, so a certificate is required to enable TLS, and certificates could also be free or paid. In this document, a free certificate is used. The certificate authority is <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let's Encrypt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
There are many ways to generate a certificate. The simpler method is used here: Using <a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener noreferrer">acme.sh<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> bash script to generate a certificate. Some of instructions in this section are referred from <a href="https://github.com/Neilpang/acme.sh/blob/master/README.md" target="_blank" rel="noopener noreferrer">acme.sh README<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>There are two types of certificates, one is the ECC certificate (the built-in public key is the ECDSA public key), and the other one is the RSA certificate (the built-in RSA public key). In other words, ECCs of the same length are more secure than RSA, which means that with the same security, the ECC key length is much shorter than RSA (so encryption and decryption will be faster). However, the ECC certificate have worse compatibility compared with the RSA certificate, and it is not supported by Android 4.x and Windows XP. As long as your devices are not unearthed artifacts, you are highly recommended to use an ECC certificate.</p> <p>Here are methods of generating both type of certificate. You can choose one of them based on your situation.</p> <p>The certificate generation process is only needed to do on your server-side.</p> <h3 id="install-acme-sh"><a href="#install-acme-sh" class="header-anchor">#</a> Install acme.sh</h3> <p>By running the following commands, <code>acme.sh</code> will be installed into <code>~/.acme.sh</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>$ curl  https://get.acme.sh | sh

% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k
[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.
[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz
[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz
[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh
[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh
[Fri 30 Dec 01:03:33 GMT 2016] Installing alias to '/home/user/.profile'
[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh
[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job
no crontab for user
no crontab for user
[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.
[Fri 30 Dec 01:03:33 GMT 2016] OK
[Fri 30 Dec 01:03:33 GMT 2016] Install success!

</code></pre></div><p>After installation finished, run <code>source ~/.bashrc</code> to ensure the command is applied to your bash environment.</p> <p>If errors prompted during installation, probably your system is missing components <code>acme.sh</code> needed, and it is highly possible to be <code>netcat (nc)</code>. If so, you can use the following command to install it (Debian-like Distribution only):</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo apt-get -y install netcat
</code></pre></div><h3 id="generate-certificate-with-acme-sh"><a href="#generate-certificate-with-acme-sh" class="header-anchor">#</a> Generate certificate with acme.sh</h3> <h4 id="generate-certificate-2"><a href="#generate-certificate-2" class="header-anchor">#</a> Generate Certificate</h4> <p>To generate certificate, simply run the following command:</p> <p>The following command will listen on port 80, so make sure it is not occupied by other processes.</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256

[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.
[Fri Dec 30 08:59:12 HKT 2016] Single domain='mydomain.me'
[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token for each domain
[Fri Dec 30 08:59:12 HKT 2016] Getting webroot for domain='mydomain.me'
[Fri Dec 30 08:59:12 HKT 2016] _w='no'
[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz for domain='mydomain.me'
[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.
[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.
[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.
[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.
[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.
[Fri Dec 30 08:59:16 HKT 2016] Cert success.
-----BEGIN CERTIFICATE-----
MIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA
MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD
ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x
NzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49
****************************************************************
4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9
+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40
zweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2
VAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9
gPUI45eltrjcv8FCSTOUcT7PWCa3
-----END CERTIFICATE-----
[Fri Dec 30 08:59:16 HKT 2016] Your cert is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer
[Fri Dec 30 08:59:16 HKT 2016] Your cert key is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key
[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is in  /root/.acme.sh/mydomain.me_ecc/ca.cer
[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer
</code></pre></div><p><code>-k</code> stands for private key length，whose value can be <code>ec-256</code> , <code>ec-384</code>, <code>2048</code>, <code>3072</code>, <code>4096</code>, and <code>8192</code>. Those with <code>ec-</code> prefix means you are generating an ECC certificate, others are RSA certificate. Speaking of security, 256-bit length ECC certificate has an equal security level of 3072-bit RSA certificate.</p> <h4 id="renew-certificate"><a href="#renew-certificate" class="header-anchor">#</a> Renew Certificate</h4> <p>As the free Let's Encrypt certificate expires every 90 days, at least one renewal is required per 90 days. By default, acme.sh will set up an auto renewal which runs every 60 days. You can also renew certificates manually.</p> <p>To manually renew an ECC certificate, run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc
</code></pre></div><p>For RSA certificates, run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force
</code></pre></div><p>** As we were generating certificates into <code>/etc/v2ray</code> folder, you also need to copy the renewed certificate into /etc/v2ray. **</p> <h3 id="install-certificate-and-private-key"><a href="#install-certificate-and-private-key" class="header-anchor">#</a> Install Certificate and Private Key</h3> <h4 id="ecc-certificate"><a href="#ecc-certificate" class="header-anchor">#</a> ECC Certificate</h4> <p>Place certificate and private key into <code>/etc/v2ray</code> folder:</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc
</code></pre></div><h4 id="rsa-certificate"><a href="#rsa-certificate" class="header-anchor">#</a> RSA Certificate</h4> <div class="language- extra-class"><pre class="language-text"><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key
</code></pre></div><p>** NOTE: DO NOT expose or leak your private key (v2ray.key file as above) in ANY circumstances to ANY person. If unfortunately you leaked it, you can use <code>acme.sh</code> to revoke it, and generate a new certificate. Detailed instructions are documented in acme.sh's own tutorials. **</p> <h2 id="configure-v2ray"><a href="#configure-v2ray" class="header-anchor">#</a> Configure V2Ray</h2> <h3 id="server-side-configuration"><a href="#server-side-configuration" class="header-anchor">#</a> Server-side configuration</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">443</span><span class="token punctuation">,</span> <span class="token comment">// recommended port</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vmess&quot;</span><span class="token punctuation">,</span>    
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;clients&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;23ad6b10-8d1a-40f7-8ad0-e3e35cd38297&quot;</span><span class="token punctuation">,</span>  
            <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span> <span class="token number">64</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;streamSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;security&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tls&quot;</span><span class="token punctuation">,</span> <span class="token comment">// set security to tls to enable tls feature</span>
        <span class="token property">&quot;tlsSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;certificates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              <span class="token property">&quot;certificateFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/etc/v2ray/v2ray.crt&quot;</span><span class="token punctuation">,</span> <span class="token comment">// certificate file</span>
              <span class="token property">&quot;keyFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/etc/v2ray/v2ray.key&quot;</span> <span class="token comment">// corresponding private key file</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;freedom&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="client-side-configuraion"><a href="#client-side-configuraion" class="header-anchor">#</a> Client-side configuraion</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;socks&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sniffing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;destOverride&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tls&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;auth&quot;</span><span class="token operator">:</span> <span class="token string">&quot;noauth&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vmess&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;vnext&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mydomain.me&quot;</span><span class="token punctuation">,</span> <span class="token comment">// tls needs domain, so fill in your own.</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">443</span><span class="token punctuation">,</span>
            <span class="token property">&quot;users&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;23ad6b10-8d1a-40f7-8ad0-e3e35cd38297&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span> <span class="token number">64</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;streamSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;security&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tls&quot;</span> <span class="token comment">// set security to tls to enable tls feature.</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="verify"><a href="#verify" class="header-anchor">#</a> Verify</h2> <p>Usually, after doing the above steps, V2Ray client already can connect to the internet, which means the TLS configuration is working. However, with a reliable way to verify if it is enabled will make it more convinced.</p> <p>There are many ways to validate the TLS, but an easy one is from  <a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener noreferrer">Qualys SSL Labs's SSL Server Test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>** NOTE: Qualys SSL Labs's SSL Server Test runs check on port 443, so you have to configure your server's inbound port to 443. **</p> <p>Click <a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener noreferrer">Qualys SSL Labs's SSL Server Test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, then input your domain into Hostname; then click submit, after a while, you will able to see the result.</p> <p><img src="/assets/img/tls_test1.fe1427b6.png" alt=""></p> <p><img src="/assets/img/tls_test2.d11e5de5.png" alt="">
This is an overall scoring to your TLS/SSL configuration, Here I got A, which is nice enough and proves our TLS is working fine.</p> <p><img src="/assets/img/tls_test3.6bbd955b.png" alt="">
Here it is your certificate information. In this screenshot, we can see it is valid through Dec 27, 2016, to Mar 27, 2017, and the encryption method used is 256-bit ECC certificate, which is signed by Let's Encrypt. Most importantly, <code>Trusted</code> status is <code>Yes</code>, which means the certificate can be trusted.</p> <h2 id="tip"><a href="#tip" class="header-anchor">#</a> Tip</h2> <p>** V2Ray is using a REAL TLS implementation rather than cloaking or obfuscation, that's why it needs domain and certificate. Also, the Websocket is REAL as well, which we'll talk about later. **</p> <hr> <h4 id="updates"><a href="#updates" class="header-anchor">#</a> Updates</h4> <ul><li>2017-08-06 Added some tips.</li> <li>2017-12-31 Typo fixed.</li> <li>2018-04-05 Update</li> <li>2018-11-17 Adapted for V4.0+</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/27/2020, 7:38:01 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en_US/advanced/httpfake.html" class="prev">
        HTTP Obfuscation
      </a></span> <span class="next"><a href="/en_US/advanced/websocket.html">
        WebSocket
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.319c1fa4.js" defer></script><script src="/assets/js/2.634a57e3.js" defer></script><script src="/assets/js/8.3afc79f6.js" defer></script>
  </body>
</html>
